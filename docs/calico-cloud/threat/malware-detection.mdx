---
title: Malware detection
description: Malware detection for containerized workloads.
---

## Big picture

Detect the presence of malware running in cloud-native applications and get alerts when malicious
programs are running in your cluster.

## Value

As part of its threat intelligence library, {{prodname}} maintains a database of malware file
hashes. This database consists of SHA256, SHA1, and MD5 hashes of executable file contents that are
known to be malicious. Whenever a program is launched in a {{prodname}} cluster, malware
detection generates an alert in the Alerts dashboard if the program's hash matches one that is known
to be malicious.

## Before you begin...

### Required

{{prodname}} malware detection uses eBPF to monitor container activity, and runs on Linux-based
nodes in a Kubernetes cluster.

Nodes require amd64 (x86_64) architecture CPUs and one of the following distributions:

-  Ubuntu Bionic with kernel version 4.15.0 or 5.4.0
-  Ubuntu Focal with kernel version 5.4.0, 5.8.0 or 5.11.0
-  CentOS 7 or 8
-  Fedora 29, 30, 31, 32, 33 or 34
-  Amazon Linux 2
-  Debian Stretch or later

:::note

If your nodes are running a variant kernel, or a similarly-modern kernel but with another platform,
please open a [Support ticket](https://support.tigera.io/)
so we can bundle the BTF data to precisely match the version of the kernel running on your cluster nodes.

:::

## How to

- [Enable malware detection in the managed cluster](#enable-malware-detection)
- [Monitor Alerts page for malicious programs](#monitor-alerts-page-for-malicious-programs)

### Enable malware detection

Malware detection is disabled by default. The DaemonSet has a nodeSelector constraint
`enable-tigera-runtime-security: t`, which means that it will not initially run on any nodes,
because there are no nodes with an `enable-tigera-runtime-security: t` label.

**Enable on all nodes**

```bash
kubectl get ds runtime-reporter -n calico-system -o yaml | sed '/enable-tigera-runtime-security/d' | kubectl apply -f -
```

:::note

-  “runtime-reporter” is the name of the malware detection DaemonSet in the managed cluster.
-  You will need to rerun that command whenever you rerun the install script to upgrade the managed
cluster.

:::

**Enable on specific nodes**

To enable malware detection on a particular node, add the `enable-tigera-runtime-security: t` label
to that node.  For example:

```bash
kubectl label nodes <node-name> enable-tigera-runtime-security=t
```

### Monitor Alerts page for malicious programs

If a malicious program is run within the cluster, it will be reported on the Alerts page of the
{{prodname}} UI.

![malware-alert-example](/img/calico-cloud/malware-alert-example.png)

## Malware detection in Kibana

Lower-level reports associated with malware detection are captured for your cluster in Kibana using
the index pattern, `tigera_secure_ee_runtime*`. Please note that most of these reports are not
usually malicious; they constitute the raw data against which known-malicious program fingerprints
are compared. Malicious matches are reported on the Alerts page of the {{prodname}} UI.
