---
title: Set up a private registry
description: Add images to a private registry for installing Calico Cloud on a cluster.
canonical_url: '/get-started/connect/setup-private-registry'
---

### Big picture

Add {{site.prodname}} images to a private registry to install new clusters or update existing ones.

### Value

In some deployments, installing {{site.prodname}} in clusters from third-party repos is not an option. Before you can install {{site.prodname}} from a private registry, you must first add {{site.prodname}} images to the registry.

### Concepts

A **container image registry** (often known as a **registry**), is a service where you can push, pull, and store container images. In Kubernetes, a registry is considered *private* if it is not publicly available.

A **private registry** is not publicly available. It must be accessible on a private network or with an **image pull secret** for authenticated access.

An **image path** is a directory in a registry that contains images required to install {{site.prodname}}.

### Before you begin

**Required**

- {% include open-new-window.html text='Helm CLI' url='https://helm.sh/docs/intro/install/' %} command
- Use the {% include open-new-window.html text='Crane command' url='https://github.com/google/go-containerregistry/blob/main/cmd/crane/README.md' %} to follow steps in this guide. (Other tools can be used, but commands be adjusted accordingly.)
- Image registry
    - Must be private (accessible only on a private network or using log in credentials)
    - Images copied to the registry must not be made publically available
    - Push access to your registry

### How to

Add the required {{site.prodname}} images to a private registry.

#### Set up registry credentials

1. Log into {{site.prodname}} and navigate to "Managed Clusters".
1. Get the "Registry Credentials" by clicking on the icon. ![registry credentials]({{site.baseurl}}/images/private-registry-icon.png)
1. Apply the credentials so the {{site.prodname}} images can be accessed.


#### Create the list of required images

```bash
helm repo add calico-cloud {{site.clouddownloadbase}}/charts
INSTALLER_IMAGE="{{site.cloudoperatorimage}}:$(helm show chart calico-cloud/calico-cloud | grep version: | sed -e 's/version: *//' -e 's/+/-g/')"
IMAGES=(
$INSTALLER_IMAGE
{% include image-list -%} )
```

#### Set up the private registry

```bash
REGISTRY=<replace with your registry and include a trailing slash>
```


If you want all images to come from the same path in your registry, set this image path value. Otherwise unset this environment variable or set it to the empty string.
```bash
IMAGEPATH=""
```

##### Image examples

| Original image | Image Registry | Image Path | Private registry image |
| ----------------------------- | --------------------- | ------------ | ------ |
| `quay.io/tigera/typha:v1.2.3` | `my.registry/` |  | `my.registry/tigera/typha:v1.2.3`|
| `quay.io/tigera/typha:v1.2.3` | `my.registry/` | `custom-path` | `my.registry/custom-path/typha:v1.2.3`|
| `us-docker.pkg.dev/tigera-prod-01/calico-cloud-public/cc-operator:v4.5.6` | `my.registry/` |  | `my.registry/calico-cloud-public/cc-operator:v4.5.6`|
| `us-docker.pkg.dev/tigera-prod-01/calico-cloud-public/cc-operator:v4.5.6` | `my.registry/` | `custom-path` | `my.registry/custom-path/cc-operator:v3.5.6`|

#### Copy images to your registry

For {{site.prodname}} to install images from your registry, copy the images from the standard registries into your own registry.

{% tabs %}
  <label:Registry only,active:true>
<%

```bash
for image in ${IMAGES[@]}; do
  img_base=$(echo ${image} | sed "s#^.*/\([^/]*/[^/]*$\)#\1#")
  crane cp ${image} ${REGISTRY}${img_base} || break
done
```

%>
  <label:Registry and ImagePath>
<%
```bash
for image in ${IMAGES[@]}; do
  img_base=$(echo ${image} | sed "s#^.*/##")
  crane cp ${image} ${REGISTRY}${IMAGEPATH}/${img_base} || break
done
```

%>
{% endtabs %}


### Install using the private registry

Follow the directions [to connect a cluster to Calico Cloud](/get-started/connect/install-cluster).
