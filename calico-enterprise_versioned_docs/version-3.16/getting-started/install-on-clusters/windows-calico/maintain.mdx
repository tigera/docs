---
description: Tasks to manage Calico services and uninstall Calico Enterprise for Windows.
---

import variables from '@site/calico-enterprise_versioned_docs/version-3.16/variables';
import CodeBlock from '@theme/CodeBlock';

# Start and stop Calico Enterprise for Windows services

## Big picture

Start, stop, and update {variables.prodnameWindows} services on the Linux control plane node, and uninstall for {variables.prodnameWindows}.

## How to

### Start and stop {variables.prodnameWindows} services

- Install and boot {variables.prodnameWindows}: `install-calico.ps1`
- Start {variables.prodnameWindows} services:`start-calico.ps1`
- Stop {variables.prodnameWindows} services: `stop-calico.ps1`

### Update {variables.prodname} services

To change the parameters defined in `config.ps1`:

- Run `uninstall-calico.ps1` to remove {variables.prodnameWindows} service configuration
- Modify the configuration
- Run `install-calico.ps1`to reinstall {variables.prodnameWindows}.

Because `config.ps1` is imported by the various component startup scripts, additional environment variables can be added, as documented in the [{variables.prodname} reference guide](../../../reference/index.mdx).

### Update service wrapper configuration

The `nssm` command supports changing a number of configuration options for the {variables.prodname} services. For example, to adjust the maximum size of the Felix log file before it is rotated:

```powershell
nssm set CalicoFelix AppRotateBytes 1048576
```

### Uninstall {variables.prodnameWindows} from Windows nodes

The following steps removes {variables.prodnameWindows} (for example to change configuration), but keeps the cluster running.

1. Remove all pods from the Windows nodes.
1. On each Windows node, run the uninstall script:

   <CodeBlock language='powershell'>
   {variables.rootDirWindows}\uninstall-calico.ps1
   </CodeBlock>

   :::note

   If you are uninstalling to change configuration, make sure that you run the uninstall script with the old configuration file.

   :::

### Uninstall kubelet and kube-proxy services from Windows nodes

The following steps uninstall kubelet/kube-proxy services if they were installed by running `{variables.rootDirWindows}\kubernetes\install-kube-services.ps1`.

1. Remove all pods from the Windows nodes.
1. On each Windows node, run the uninstall script:

   <CodeBlock language=''>
   {variables.rootDirWindows}\kubernetes\uninstall-kube-services.ps1
   </CodeBlock>

1. If desired, delete the `{variables.rootDirWindows}` directory.
