---
description: Securely connect your cluster to Calico Cloud Free Tier to access centralized network observability for your Kubernetes deployment.
title: Connect a cluster
---

# Connect a cluster to Calico Cloud Free Tier

This page shows you how to connect your Kubernetes cluster to Calico Cloud Free Tier.

:::tip
Don't have a cluster ready to connect?
Try the [Calico Cloud Free Tier quickstart guide](quickstart.mdx) to create a cluster locally and connect it to Calico Cloud Free Tier.
:::

## Prerequisites

* You have a Kubernetes cluster.
  * Your `kubectl` tool is configured to communicate with your cluster.
  * If you're working in a restricted network environment, you are able to create allow rules for TCP egress traffic to the Calico Cloud management plane.
* You [installed Calico Open Source 3.30 or later on your cluster](/calico/latest/getting-started).
  * If you upgraded from an earlier version of Calico Open Source, you [enabled the `Goldmane` custom resource](/calico/latest/observability/enable-whisker).
  * Calico Open Source was installed using the operator method.
    Manifest- and Helm-based installations are not supported.
  <details>
    <summary>Check Calico compatibility</summary>

    To confirm that you're on a compatible Calico setup, you can run the following command:

    ```bash
    kubectl get tigerastatus goldmane
    ```

    If you're running Calico Open Source 3.30+ with the `Goldmane` custom resource is enabled, you should see something like this:

    ```bash title='Example output'
    NAME       AVAILABLE   PROGRESSING   DEGRADED   SINCE
    goldmane   True        False         False      21h
    ```
    This cluster is ready to connect to Calico Cloud Free Tier.

    If instead you get an error (`Error from server (NotFound): tigerastatuses.operator.tigera.io "goldmane" not found`), then you need to do one of the following:
    * If you're already on 3.30+ [enable the `Goldmane` custom resource](/calico/latest/observability/enable-whisker).
    * If you're on 3.29 or earlier, [upgrade your Calico installation to 3.30 or later](/calico/latest/operations/upgrading/kubernetes-upgrade#upgrading-an-installation-that-uses-the-operator) and then [enable the `Goldmane` custom resource](/calico/latest/observability/enable-whisker).
  </details>
* You have an active Calico Cloud Free Tier account.
  To create an account, go to the [Calico Cloud Free Tier sign-up page](https://calicocloud.io).
* You are signed in to the $[prodname] web console.

## Connect your cluster

1. From the web console, click the **Connect a cluster** button on the welcome screen.
1. Follow the prompts to create a name for your cluster and copy a `kubectl` command to run in your cluster.

    <details>
     <summary>What's happening in this command?</summary>

   This command creates three resources in your cluster:
   * **A `ManagementClusterConnection` resource**.
     This resource specifies the address of the Calico Cloud management cluster.
   * **A `Secret` resource (`tigera-managed-cluster-connection`)**.
     This resource provides certificates for secure communication between your cluster and the Calico Cloud management cluster.
   * **A `Secret` resource (`tigera-voltron-linseed-certs-public`)**.
     This resource provides certificates for secure communications for the specific components that Calico Cloud uses for log data and observability.

   ```bash title='Example of generated kubectl command to connect a cluster to Calico Cloud Free Tier'
   kubectl apply -f - <<EOF
   # Once applied to your managed cluster, a deployment is created to establish a secure tcp connection
   # with the management cluster.

   apiVersion: operator.tigera.io/v1
   kind: ManagementClusterConnection
   metadata:
   name: tigera-secure
   spec:
   # ManagementClusterAddr should be the externally reachable address to which your managed cluster
   # will connect. Valid examples are: "0.0.0.0:31000", "example.com:32000", "[::1]:32500"
   managementClusterAddr: "oss-ui-01-management.calicocloud.io:443"

   ---

   apiVersion: v1
   kind: Secret
   metadata:
   name: tigera-managed-cluster-connection
   namespace: tigera-operator
   type: Opaque
   data:
   # This is the certificate of the management cluster side of the tunnel.
   management-cluster.crt: ...
   # The certificate and private key that are created and signed by the CA in the management cluster.
   managed-cluster.crt: ...
   managed-cluster.key: ...

   ---
   apiVersion: v1
   kind: Secret
   metadata:
   name: tigera-voltron-linseed-certs-public
   namespace: tigera-operator
   type: Opaque
   data:
   tls.crt: ...

   EOF
   ```
   </details>

1. To start the connection process, run the `kubectl` command in your terminal.

   ```bash title='Sample output'
   managementclusterconnection.operator.tigera.io/tigera-secure created
   secret/tigera-managed-cluster-connection created
   secret/tigera-voltron-linseed-certs-public created
   ```

1. After your run the command, click **I applied the manifest** to continue.

## Verify your connection

* From the web console, click **Managed clusters** to view a list of managed clusters.
  If your cluster connected successfully, you'll see its connection status is **Connected**.

## Troubleshooting

This section describes solutions to common connection problems.

### Connection status is **Connected**, but there is no data in my dashboards or Service Graph

#### Cause: The `Goldmane` resource is not enabled

Goldmane is the component that serves the flow logs API.
Without it, your cluster may be able to connect to Calico Cloud Free Tier, but it won't be able to provide flow logs.

To fix this problem:

* [Enable `Goldmane` custom resource](/calico/latest/observability/enable-whisker).

  A few minutes after you apply the `Goldmane` resource, you will begin to see data in your dashboards and Service Graph.

### Connection status remains **Disconnected** after applying the connection manifest

#### Cause 1: Your cluster is running Calico Open Source 3.29 or earlier

Clusters with Calico Open Source 3.29 or earlier can't connect to Calico Cloud Free Tier.

After applying the connection manifest, you may get output like this:

```bash
secret/tigera-managed-cluster-connection created
secret/tigera-voltron-linseed-certs-public created
error: resource mapping not found for name: "tigera-secure" namespace: "" from "STDIN": no matches for kind "ManagementClusterConnection" in version "operator.tigera.io/v1"
ensure CRDs are installed first
```

To fix this problem:

1. [Upgrade your cluster to Calico Open Source 3.30 or later](/calico/latest/operations/upgrading/kubernetes-upgrade#upgrading-an-installation-that-uses-the-operator) and [enable the `Goldmane` resource](/calico/latest/observability/enable-whisker).
1. Reapply the connection manifest.

#### Cause 2: Your network environment restricts egress traffic to the Calico Cloud management cluster

If your network environment restricts egress traffic to the Calico Cloud management cluster, you need to create allow rules so your cluster can connect.

To fix this problem:

1. Locate the address of the Calico Cloud management cluster in the `ManagementClusterAddr` field of the `ManagementClusterConnection` resource:

   ```bash
   kubectl get managementclusterconnection tigera-secure -o jsonpath='{.spec.managementClusterAddr}'
   ```

   You'll see something like this:

   ```bash title='Sample output'
   oss-ui-01-management.calicocloud.io:443
   ```

1. Make sure your network allows TCP egress traffic to this address.


## Next steps

* To try out the observability tools with demo applications, follow the quickstart guide from [Step 4. Deploy NGINX and BusyBox to generate traffic](quickstart.mdx#step-4-deploy-nginx-and-busybox-to-generate-traffic).
* [Remove a cluster from Calico Cloud Free Tier](disconnect-cluster-free.mdx)